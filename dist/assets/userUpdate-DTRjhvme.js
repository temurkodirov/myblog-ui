import{g as k,u as x,o as r,c as d,a as e,e as u,t as m,j as N,F as y,h as w,k as p,v as f,n as b,l as M,i as B,p as U,f as I}from"./index-BxNye9P6.js";import{i as L}from"./imagePathfixer-CcxXgNhq.js";import{u as T}from"./index-rtgCEYFi.js";import{c,r as g,m as v,a as _}from"./index-DdAual5n.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const C="/assets/1-DL1ARROH.png",S={name:"userUpdate",data(){return{user:{id:0,firstName:"",lastName:"",isMale:!1,email:"",phoneNumber:"",imagePath:"",createdAt:"2024-08-29T07:13:50.993016Z",updatedAt:"2024-08-29T07:13:50.993016Z"},userId:0,m_files:[],updating:{step1:!1,step2:!1,step3:!1}}},methods:{imagePathfixer:L,async fetchUser(){let a=await k.get("people/get/"+this.userId);a.status===200&&(this.user={...a.data})},filesChangeHandler(a){this.m_files=[];let s=a.target.files;for(let l=0;l<s.length;l++)this.m_files.push({bb:window.URL.createObjectURL(s[l]),file:s[l]})},successToast(){this.toast.success("Muvaffaqiyatlik yakunlandi",{position:"top-right",timeout:1800,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!1,closeButton:"button",icon:!0,rtl:!1})},errorToast(){this.toast.error("Xatolik yuz berdi",{position:"top-right",timeout:1800,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!1,closeButton:"button",icon:!0,rtl:!1})},async updateUser(){if(this.v$.user.$touch(),this.v$.user.$invalid){window.scrollTo({top:0,behavior:"smooth"});return}const a=new FormData;for(let l=0;l<this.m_files.length;l++)a.append("Image",this.m_files[l].file);a.append("FirstName",this.user.firstName),a.append("LastName",this.user.lastName),a.append("IsMale",this.user.isMale),a.append("PhoneNumber",this.user.phoneNumber);let s={headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"multipart/form-data"}};try{this.updating.step1=!0,this.updating.step2=!0,(await k.post("people/update",a,s)).status===200&&(localStorage.clear(),setTimeout(()=>{this.updating.step2=!1,this.updating.step3=!0},1300),setTimeout(()=>{this.successToast()},1500),setTimeout(()=>{this.$router.push("/auth/login")},1500))}catch(l){this.errorToast(),console.log(l.message)}}},async mounted(){let a=await JSON.parse(localStorage.getItem("lokalUser"));this.userId=a.userId,await this.fetchUser()},setup(){const a=T(),s=x();return{v$:a,toast:s}},validations:{user:{firstName:{required:c.withMessage("Yozilishi shart",g),minLength:c.withMessage("3 ta belgidan ko'p  bo'lishi kerak",v(3)),maxLength:c.withMessage("100 ta belgidan kam bo'lishi kerak",_(100))},lastName:{required:c.withMessage("Yozilishi shart",g),minLength:c.withMessage("3 ta belgidan ko'p  bo'lishi kerak",v(3)),maxLength:c.withMessage("100 ta belgidan kam bo'lishi kerak",_(100))},phoneNumber:{required:c.withMessage("Yozilishi shart",g),minLength:c.withMessage("3 ta belgidan ko'p  bo'lishi kerak",v(9)),maxLength:c.withMessage("100 ta belgidan kam bo'lishi kerak",_(10))}}}},i=a=>(U("data-v-be23ae6f"),a=a(),I(),a),O={class:"container"},D={class:"row"},q={class:"col-lg-8 mx-auto my-5"},j={class:"card"},V=i(()=>e("h5",{class:"card-header"},"Mening sahifam",-1)),H={class:"card-body"},z={class:"d-flex align-items-start align-items-sm-center gap-4"},A={key:0,src:C,alt:"user-avatar",class:"d-block rounded",height:"100",width:"100",id:"uploadedAvatar"},F=["src"],Y={class:"button-wrapper"},E={class:"fw-bold m-0"},R={class:"fw-bold m-0"},J={class:"fw-bold m-0"},Z=i(()=>e("hr",{class:"my-0"},null,-1)),X={class:"card-body"},G={class:"row"},K={class:"row mb-3"},Q={class:"d-flex justify-content-center"},W={class:"image-container gap-2 d-flex flex-wrap"},$=["src"],ee=i(()=>e("label",{for:"forimages",class:"form-label"},"Profil uchun rasm",-1)),se={class:""},te=i(()=>e("p",{class:"text-muted mb-0 ms-2"},"Jpg turdagi rasmlarni yuklay olasiz",-1)),ae={class:"mb-3"},oe=i(()=>e("label",{for:"firstName",class:"form-label"},"Ism ",-1)),ie={key:0,class:"invalid-input-text"},le={class:"mb-3"},re=i(()=>e("label",{for:"lastName",class:"form-label"},"Familiya ",-1)),de={key:0,class:"invalid-input-text"},ne={class:"mb-3"},ce=i(()=>e("label",{for:"email",class:"form-label"},"E-mail",-1)),ue={class:"mb-3"},me=i(()=>e("label",{class:"form-label",for:"phoneNumber"},"Phone Number",-1)),he={class:"input-group input-group-merge"},pe=i(()=>e("span",{class:"input-group-text"},"UZB (+998)",-1)),fe={key:0,class:"invalid-input-text"},be={class:"mb-3"},ge=i(()=>e("label",{for:"language",class:"form-label"},"Jins",-1)),ve=i(()=>e("option",{value:!0},"Erkak",-1)),_e=i(()=>e("option",{value:!1},"Ayol",-1)),ke=[ve,_e],ye={class:"mt-2 d-flex justify-content-end"},xe={key:0,class:"mt-3"},Ne={class:"modal fade show",id:"backDropModal","data-bs-backdrop":"static",tabindex:"-1",style:{display:"block","padding-left":"0",background:"rgba(0,0,0,0.8)"},"aria-modal":"true",role:"dialog"},we={class:"modal-dialog modal-dialog-centered"},Me={class:"modal-content"},Be=i(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"backDropModalTitle"},"Profil yangilanmoqda")],-1)),Ue={class:"modal-body"},Ie={key:0},Le=i(()=>e("div",{class:"d-flex justify-content-center"},[e("div",{class:"spinner-border spinner-border-lg text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")])],-1)),Te=i(()=>e("div",{class:"d-flex justify-content-center mt-1"},[e("p",{class:""},"Iltimos kuting...")],-1)),Pe=[Le,Te],Ce={key:1},Se=i(()=>e("div",{class:"d-flex justify-content-center"},[e("p",{class:"fs-4"},"Muvafiqiyatlik yakunlandi"),e("p",{class:""},[e("i",{class:"fs-1 text-lg bx bx-check",style:{color:"#3be111"}})])],-1)),Oe=[Se],De=B('<div class="modal fade" id="backDropModal" data-bs-backdrop="static" tabindex="-1" aria-hidden="true" style="display:none;" data-v-be23ae6f><div class="modal-dialog" data-v-be23ae6f><form class="modal-content" data-v-be23ae6f><div class="modal-header" data-v-be23ae6f><h5 class="modal-title" id="backDropModalTitle" data-v-be23ae6f>Modal title</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" data-v-be23ae6f></button></div><div class="modal-body" data-v-be23ae6f><div class="row" data-v-be23ae6f><div class="col mb-3" data-v-be23ae6f><label for="nameBackdrop" class="form-label" data-v-be23ae6f>Name</label><input type="text" id="nameBackdrop" class="form-control" placeholder="Enter Name" data-v-be23ae6f></div></div><div class="row g-2" data-v-be23ae6f><div class="col mb-0" data-v-be23ae6f><label for="emailBackdrop" class="form-label" data-v-be23ae6f>Email</label><input type="text" id="emailBackdrop" class="form-control" placeholder="xxxx@xxx.xx" data-v-be23ae6f></div><div class="col mb-0" data-v-be23ae6f><label for="dobBackdrop" class="form-label" data-v-be23ae6f>DOB</label><input type="text" id="dobBackdrop" class="form-control" placeholder="DD / MM / YY" data-v-be23ae6f></div></div></div><div class="modal-footer" data-v-be23ae6f><button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal" data-v-be23ae6f> Close </button><button type="button" class="btn btn-primary" data-v-be23ae6f>Save</button></div></form></div></div>',1);function qe(a,s,l,n,t,h){return r(),d(y,null,[e("div",O,[e("div",D,[e("div",q,[e("div",j,[V,e("div",H,[e("div",z,[t.user.imagePath===null||t.user.imagePath.length===0?(r(),d("img",A)):u("",!0),e("img",{src:h.imagePathfixer(t.user.imagePath),class:"d-block rounded",height:"100",width:"100",alt:"avatar"},null,8,F),e("div",Y,[e("p",E,m(t.user.firstName)+" "+m(t.user.lastName),1),e("p",R,m(t.user.email),1),e("p",J,m(t.user.phoneNumber),1)])])]),Z,e("div",X,[e("form",{id:"formAccountSettings",method:"POST",onsubmit:"return false",onSubmit:s[7]||(s[7]=N(()=>{},["prevent"]))},[e("div",G,[e("div",K,[e("div",Q,[e("div",W,[(r(!0),d(y,null,w(t.m_files,o=>(r(),d("div",{key:o.bb},[e("img",{src:o.bb,alt:"Image preview",class:"previewImage"},null,8,$)]))),128))])]),ee,e("div",se,[e("input",{onChange:s[0]||(s[0]=(...o)=>h.filesChangeHandler&&h.filesChangeHandler(...o)),type:"file",id:"files",name:"files[]",class:"form-control",accept:"image/x-png, image/jpeg, image/jpg",required:""},null,32),te])]),e("div",ae,[oe,p(e("input",{class:b(["form-control",{"invalid-input":n.v$.user.firstName.$error}]),required:"","onUpdate:modelValue":s[1]||(s[1]=o=>t.user.firstName=o),type:"text",id:"firstName",name:"firstName",autofocus:""},null,2),[[f,t.user.firstName]]),n.v$.user.firstName.$error?(r(),d("div",ie,m(n.v$.user.firstName.$errors[0].$message),1)):u("",!0)]),e("div",le,[re,p(e("input",{class:b(["form-control",{"invalid-input":n.v$.user.lastName.$error}]),required:"","onUpdate:modelValue":s[2]||(s[2]=o=>t.user.lastName=o),type:"text",id:"firstName",name:"firstName",autofocus:""},null,2),[[f,t.user.lastName]]),n.v$.user.lastName.$error?(r(),d("div",de,m(n.v$.user.lastName.$errors[0].$message),1)):u("",!0)]),e("div",ne,[ce,p(e("input",{class:"form-control",type:"text",id:"email",name:"email","onUpdate:modelValue":s[3]||(s[3]=o=>t.user.email=o),disabled:"",placeholder:"john.doe@example.com"},null,512),[[f,t.user.email]])]),e("div",ue,[me,e("div",he,[pe,p(e("input",{type:"text",id:"phoneNumber",required:"","onUpdate:modelValue":s[4]||(s[4]=o=>t.user.phoneNumber=o),class:b([{"invalid-input":n.v$.user.phoneNumber.$error},"form-control"]),name:"phoneNumber",placeholder:"889997730"},null,2),[[f,t.user.phoneNumber]]),n.v$.user.phoneNumber.$error?(r(),d("div",fe,m(n.v$.user.phoneNumber.$errors[0].$message),1)):u("",!0)])]),e("div",be,[ge,p(e("select",{id:"language","onUpdate:modelValue":s[5]||(s[5]=o=>t.user.isMale=o),class:"select2 form-select"},ke,512),[[M,t.user.isMale]])])]),e("div",ye,[e("button",{type:"submit",onClick:s[6]||(s[6]=(...o)=>h.updateUser&&h.updateUser(...o)),class:"btn btn-primary me-2"},"Yangilash")])],32)])])])])]),t.updating.step1?(r(),d("div",xe,[e("div",Ne,[e("div",we,[e("form",Me,[Be,e("div",Ue,[t.updating.step2?(r(),d("div",Ie,Pe)):u("",!0),t.updating.step3?(r(),d("div",Ce,Oe)):u("",!0)])])])]),De])):u("",!0)],64)}const Fe=P(S,[["render",qe],["__scopeId","data-v-be23ae6f"]]);export{Fe as default};
