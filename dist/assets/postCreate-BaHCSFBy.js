import{g as h,u as C,o as i,c as r,a as e,j as x,k as u,v as p,n as f,t as g,e as _,l as B,F as b,h as v,p as S,f as L}from"./index-BxNye9P6.js";import{c,r as y,m as w,a as k}from"./index-DdAual5n.js";import{u as I}from"./index-rtgCEYFi.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";const O={name:"postCreate",data(){return{categories:[],post:{title:"",content:"",categoryId:0,images:[]},selectedCategory:null,m_files:[]}},methods:{filesChangeHandler(s){this.m_files=[];let t=s.target.files;for(let a=0;a<t.length;a++)this.m_files.push({bb:window.URL.createObjectURL(t[a]),file:t[a]})},async fetchCategory(){try{let s=await h.get("category/get-all?PageSize=50");s.status===200&&(this.categories=s.data.items,this.selectedCategory=this.categories[0].id)}catch(s){console.error(s.message)}},successToast(){this.toast.success("Muvaffaqiyatlik yakunlandi",{position:"top-right",timeout:1800,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!1,closeButton:"button",icon:!0,rtl:!1})},errorToast(){this.toast.error("Xatolik yuz berdi",{position:"top-right",timeout:1800,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!1,closeButton:"button",icon:!0,rtl:!1})},async createPost(){if(this.v$.post.$touch(),this.v$.post.$invalid){window.scrollTo({top:0,behavior:"smooth"});return}const s=new FormData;for(let a=0;a<this.m_files.length;a++)s.append("Images",this.m_files[a].file);s.append("Title",this.post.title),s.append("Content",this.post.content),s.append("CategoryId",this.selectedCategory);let t={headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"multipart/form-data"}};try{(await h.post("post/create",s,t)).status===200&&(this.successToast(),this.$router.push("/blogs"))}catch(a){console.log(a.message)}}},setup(){const s=I(),t=C();return{v$:s,toast:t}},validations:{post:{title:{required:c.withMessage("Yozilishi shart",y),minLength:c.withMessage("3 ta belgidan ko'p  bo'lishi kerak",w(3)),maxLength:c.withMessage("100 ta belgidan kam bo'lishi kerak",k(100))},content:{required:c.withMessage("Yozilishi shart",y),minLength:c.withMessage("3 ta belgidan ko'p  bo'lishi kerak",w(3)),maxLength:c.withMessage("150000 ta belgidan kam bo'lishi kerak",k(15e4))}}},async mounted(){await this.fetchCategory()}},d=s=>(S("data-v-28d3ba95"),s=s(),L(),s),j={class:"container"},z={class:"row justify-content-center mt-5"},P={class:"col-lg-8 col-xl-6 col-md-12 col-sm-12"},T={class:"card mb-4"},F=d(()=>e("div",{class:"card-header d-flex align-items-center justify-content-between"},[e("h5",{class:"mb-0"},"Yangi blog yaratish")],-1)),H={class:"card-body"},$={class:"row mb-3"},V=d(()=>e("label",{class:"col-sm-2 col-form-label",for:"basic-default-name"},"Sarlavha",-1)),q={class:"col-sm-10"},D={key:0,class:"invalid-input-text"},U={class:"row mb-3"},Y=d(()=>e("label",{class:"col-sm-2 col-form-label",for:"basic-default-message"},"Blog",-1)),R={class:"col-sm-10"},N={key:0,class:"invalid-input-text"},A={class:"row mb-3"},E=d(()=>e("label",{class:"col-sm-2 form-label",for:"exampleFormControlSelect1"},"Blog turi",-1)),X={class:"col-sm-10"},G=["value"],J={class:"row mb-3"},K=d(()=>e("label",{for:"forimages",class:"col-sm-2 col-form-label"},"Rasmlar",-1)),Q={class:"col-sm-10"},W={class:"row mb-3"},Z=d(()=>e("label",{class:"col-sm-2"},null,-1)),ee={class:"col-sm-10 image-container gap-2 d-flex flex-wrap"},te=["src"],se={class:"row justify-content-end"},oe={class:"col-sm-10"},ae={class:"d-flex justify-content-end"};function le(s,t,a,n,l,m){return i(),r("div",j,[e("div",z,[e("div",P,[e("div",T,[F,e("div",H,[e("form",{onSubmit:t[5]||(t[5]=x(()=>{},["prevent"]))},[e("div",$,[V,e("div",q,[u(e("input",{type:"text",class:f(["form-control",{"invalid-input":n.v$.post.title.$error}]),"onUpdate:modelValue":t[0]||(t[0]=o=>l.post.title=o),id:"basic-default-name",placeholder:"Sarlavha"},null,2),[[p,l.post.title]]),n.v$.post.title.$error?(i(),r("div",D,g(n.v$.post.title.$errors[0].$message),1)):_("",!0)])]),e("div",U,[Y,e("div",R,[u(e("textarea",{id:"basic-default-message",class:f(["form-control",{"invalid-input":n.v$.post.content.$error}]),"onUpdate:modelValue":t[1]||(t[1]=o=>l.post.content=o),rows:"4",placeholder:"Blog matnini shu yerga yozing...","aria-label":"Blog matnini shu yerga yozing...","aria-describedby":"basic-icon-default-message2"},null,2),[[p,l.post.content]]),n.v$.post.content.$error?(i(),r("div",N,g(n.v$.post.content.$errors[0].$message),1)):_("",!0)])]),e("div",A,[E,e("div",X,[u(e("select",{class:"form-select","onUpdate:modelValue":t[2]||(t[2]=o=>l.selectedCategory=o),id:"exampleFormControlSelect1","aria-label":"Default select example"},[(i(!0),r(b,null,v(l.categories,o=>(i(),r("option",{value:o.id},g(o.name),9,G))),256))],512),[[B,l.selectedCategory]])])]),e("div",J,[K,e("div",Q,[e("input",{onChange:t[3]||(t[3]=(...o)=>m.filesChangeHandler&&m.filesChangeHandler(...o)),type:"file",id:"files",name:"files[]",class:"form-control",accept:"image/x-png, image/jpeg, image/jpg",multiple:"",required:""},null,32)])]),e("div",W,[Z,e("div",ee,[(i(!0),r(b,null,v(l.m_files,o=>(i(),r("div",{key:o.bb},[e("img",{src:o.bb,alt:"Image preview",class:"previewImage"},null,8,te)]))),128))])]),e("div",se,[e("div",oe,[e("div",ae,[e("button",{onClick:t[4]||(t[4]=(...o)=>m.createPost&&m.createPost(...o)),type:"submit",class:"btn btn-primary"},"Yaratish")])])])],32)])])])])])}const de=M(O,[["render",le],["__scopeId","data-v-28d3ba95"]]);export{de as default};
